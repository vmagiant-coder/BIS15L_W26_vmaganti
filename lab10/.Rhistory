group_by(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(incident_num)) %>%
slice_head(n=5) %>%
distinct() %>%
count() %>%
sharks %>%
select(county, incident_num) %>%
group_by(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(incident_num)) %>%
slice_head(n=5) %>%
distinct() %>%
count()
sharks %>%
select(county, incident_num) %>%
group_by(county) %>%
distinct() %>%
count() %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(incident_num)) %>%
slice_head(n=5)
sharks %>%
select(county, incident_num) %>%
group_by(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(incident_num)) %>%
slice_head(n=5)
sharks %>%
select(county) %>%
group_by(county) %>%
distinct() %>%
count() %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(incident_num)) %>%
slice_head(n=5)
sharks %>%
select(county) %>%
group_by(county) %>%
count() %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(incident_num)) %>%
slice_head(n=5)
sharks %>%
select(county) %>%
group_by(county) %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(incident_num)) %>%
slice_head(n=5)
sharks %>%
select(county) %>%
group_by(county) %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(county)) %>%
slice_head(n=5)
sharks %>%
select(county) %>%
group_by(county) %>%
distinct() %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(county)) %>%
slice_head(n=5)
sharks %>%
select(county) %>%
group_by(county) %>%
distinct() %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(n)) %>%
slice_head(n=5)
sharks %>%
select(county) %>%
group_by(county) %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(n)) %>%
slice_head(n=5)
sharks %>%
ggplot(aes(x=county)) +
geom_bar(aes(fill=county))
sharks %>%
ggplot(aes(x=county)) +
geom_bar(aes(fill=county))+
coord_flip() +
labs(title="Total Number of Incidents by County", x="County", y = "Number of Incidents")
sharks %>%
ggplot(aes(x=county)) +
geom_bar(aes(fill=county))+
coord_flip() +
labs(title="Total Number of Incidents by County", x="County", y = "Number of Incidents") +
scale_y_log10()
sharks %>%
ggplot(aes(x=county)) +
geom_bar(aes(fill=county))+
coord_flip() +
labs(title="Total Number of Incidents by County", x="County", y = "Number of Incidents")
sharks %>%
ggplot(aes(x=county)) +
geom_bar(aes(fill=county))+
coord_flip() +
labs(title="Total Number of Incidents by County", x="County", y = "Number of Incidents") +
scale_y_log10()
sharks %>%
ggplot(aes(x=month)) +
geom_bar(aes(fill=month))+
coord_flip() +
labs(title="Total Number of Incidents by Month", x="Month", y = "Number of Incidents") +
scale_y_log10()
sharks %>%
ggplot(aes(x=month)) +
geom_bar(aes(fill=month))+
coord_flip() +
labs(title="Total Number of Incidents by Month", x="Month", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x=month)) +
geom_bar(aes(fill=month))+
coord_flip() +
labs(title="Total Number of Shark Incidents by Month", x="Month", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x= as.factor(month))) +
geom_bar(aes(fill= as.factor(month)))+
coord_flip() +
labs(title="Total Number of Shark Incidents by Month", x="Month", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x= as.factor(month))) +
geom_bar(aes(fill= as.factor(month)))+
labs(title="Total Number of Shark Incidents by Month", x="Month", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x=county)) +
geom_bar(aes(fill=county))+
coord_flip() +
labs(title="Total Number of Incidents by County", x="County", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
select(month) %>%
group_by(month) %>%
count(month) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(n)) %>%
slice_head(n=1)
sharks %>%
select(county) %>%
group_by(county) %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(n)) %>%
slice_head(n=5)
library("tidyverse")
library("janitor")
sharks <-
read_csv("data/SharkIncidents_1950_2022_220302.csv",
na=c("NA", "N/A", "Unknown", "NOT COUNTED", "", " ")) %>%
clean_names()
names(sharks)
sharks
sharks %>%
select(county) %>%
group_by(county) %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm=T))) %>%
arrange(desc(n)) %>%
slice_head(n=5)
sharks %>%
ggplot(aes(x=county)) +
geom_bar(aes(fill=county))+
coord_flip() +
labs(title="Total Number of Incidents by County", x="County", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x= as.factor(month))) +
geom_bar(aes(fill= as.factor(month)))+
labs(title="Total Number of Shark Incidents by Month", x="Month", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
count(county, sort = T) %>%
slice_head(n=5)
sharks %>%
ggplot(aes(x=county)) +
geom_bar()+
coord_flip() +
labs(title="Total Number of Incidents by County", x="County", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x= as.factor(month), fill = Month)) +
geom_bar(aes(fill= as.factor(month)))+
labs(title="Total Number of Shark Incidents by Month", x="Month", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x= as.factor(month), fill = "Month")) +
geom_bar(aes(fill= as.factor(month)))+
labs(title="Total Number of Shark Incidents by Month", x="Month", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x= as.factor(month), fill = as.factor(month))) +
geom_bar(aes(fill= as.factor(month)))+
labs(title="Total Number of Shark Incidents by Month", x="Month", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x= as.factor(month))) +
geom_bar(aes(fill= as.factor(month)))+
labs(title="Total Number of Shark Incidents by Month", x="Month", y = "Number of Incidents", fill = "Month") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
scale_y_log10()
sharks %>%
ggplot(aes(x=time)) +
geom_bar()+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(width = 0.6)+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(width = 5)+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(width = 0.6)+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar()+
coord_flip() +
geom_text(aes(label = time), lineheight = 1.4, size = 3) +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar()+
coord_flip() +
geom_text(aes(label = time), lineheight = 1.4, size = 3) +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar()+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
geom_text(aes(label = time), lineheight = 1.4, size = 3) +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar()+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar()+
coord_flip() +
geom_text(aes(label = time),
position = position_dodge(width = 0.9),
size = 3) +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_col()+
coord_flip() +
geom_text(aes(label = n),
hjust = -0.1,
size = 3) +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_col()+
coord_flip() +
geom_text(aes(label = time),
hjust = -0.1,
size = 3) +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_col()+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar()+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(na.rm = T)+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(na.rm = T)+
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(na.rm = T)+
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
theme(axis.text.x = element_text(angle=60, hjust = 1))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(na.rm = T)+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
theme(axis.text.x = element_text(angle=60, hjust = 1))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(na.rm = T)+
coord_flip() +
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
theme(axis.text.y = element_text(angle=60, hjust = 1))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(na.rm = T)+
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
theme(axis.text.x = element_text(angle=60, hjust = 1))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(aes(fill=time), na.rm = T)+
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
theme(axis.text.x = element_text(angle=60, hjust = 1))
sharks %>%
ggplot(aes(x=time)) +
geom_bar(na.rm = T)+
labs(title = "Shark Incidents by Time of Day", x = "Time of Day", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) +
theme(axis.text.x = element_text(angle=60, hjust = 1))
injury_table <- sharks %>%
count(county, injury) %>%
pivot_wider(
names_from = injury,
values_from = n,
values_fill = 0
)
injury_table <- sharks %>%
count(county, injury) %>%
pivot_wider(
names_from = injury,
values_from = n,
values_fill = 0
)
injury_table
sharks %>%
coount(county, sort = T) %>%
slice_head(n=1)
sharks %>%
count(county, sort = T) %>%
slice_head(n=1)
injury_table %>%
ggplot(aes(x=county, y= total_incidents)) +
geom_col() +
coord_flip() +
labs(title = "Total Shark Incidents by County", x= "County", y = "Total Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
injury_table %>%
ggplot(aes(x=county)) +
geom_bar() +
coord_flip() +
labs(title = "Total Shark Incidents by County", x= "County", y = "Total Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
group_by(county) %>%
summarize(total_incidents = n()) %>%
ggplot(aes(x=county)) +
geom_bar() +
coord_flip() +
labs(title = "Total Shark Incidents by County", x= "County", y = "Total Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
injury_table %>%
mutate(total_incidents = minor + `none` + major + `minor*` + `none*` + fatal + `major*`) %>%
ggplot(aes(x=county, y = total_incidents)) +
geom_col(fill = "steelblue", na.rm = T) +
coord_flip() +
labs(title = "Total Shark Incidents by County", x = "County", y = "Total Incidents")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
injury_table %>%
mutate(total_incidents = minor + `none` + major + `minor*` + `none*` + fatal + `major*`) %>%
ggplot(aes(x=county, y = total_incidents)) +
geom_col(fill = "pink", na.rm = T) +
coord_flip() +
labs(title = "Total Shark Incidents by County", x = "County", y = "Total Incidents")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
injury_table %>%
mutate(total_incidents = minor + `none` + major + `minor*` + `none*` + fatal + `major*`) %>%
ggplot(aes(x=county, y = total_incidents)) +
geom_col(fill = "deeppink3", na.rm = T) +
coord_flip() +
labs(title = "Total Shark Incidents by County", x = "County", y = "Total Incidents")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
sharks %>%
count(mode, sort = T)
sharks %>%
count(species, sort = T)
sharks %>%
count(species, sort = T)
slice_head(n=1)
sharks %>%
count(species, sort = T) %>%
slice_head(n=1)
sharks %>%
count(mode, sort = T)
sharks %>%
count(mode, sort = T) %>%
slice_head(n=1)
great_white <- sharks %>%
filter(shark_species == "White") %>%
ggplot(aes(x=injury)) +
geom_bar(fill = "tomato") +
labs(title = "Incident Outcomes for Great White Sharks", x = "Injury Type", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
great_white <- sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury)) +
geom_bar(fill = "tomato") +
labs(title = "Incident Outcomes for Great White Sharks", x = "Injury Type", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
great_white <- sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury)) +
geom_bar(fill = "tomato") +
labs(title = "Incident Outcomes for Great White Sharks", x = "Injury Type", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
great_white
great_white <- sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury)) +
geom_bar(fill = injury) +
labs(title = "Incident Outcomes for Great White Sharks", x = "Injury Type", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
great_white <- sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury)) +
geom_bar(aes(fill = injury)) +
labs(title = "Incident Outcomes for Great White Sharks", x = "Injury Type", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
great_white <- sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury)) +
geom_bar(aes(fill = injury)) +
labs(title = "Incident Outcomes for Great White Sharks", x = "Injury Type", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
great_white
activity_counts <- sharks %>%
group_by(injury) %>%
summarize(total_incidents = n()) %>%
ggplot(aes(x = injury, y = total_incidents)) +
geom_col() +
coord_flip() +
labs(title = "Incident Outcomes for Great White Sharks", x = "Injury Type", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
activity_counts <- sharks %>%
group_by(mode) %>%
summarize(total_incidents = n()) %>%
ggplot(aes(x = mode, y = total_incidents)) +
geom_col() +
coord_flip() +
labs(title = "Shark Incidents by Activity", x = "Activity", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
activity_counts
activity_counts <- sharks %>%
group_by(mode) %>%
summarize(total_incidents = n()) %>%
ggplot(aes(x = mode, y = total_incidents)) +
geom_col(aes(fill=mode)) +
coord_flip() +
labs(title = "Shark Incidents by Activity", x = "Activity", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
activity_counts <- sharks %>%
group_by(mode) %>%
summarize(total_incidents = n()) %>%
ggplot(aes(x = mode, y = total_incidents)) +
geom_col(aes(fill=mode)) +
coord_flip() +
labs(title = "Shark Incidents by Activity", x = "Activity", y = "Number of Incidents") +
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
activity_counts
